# 데이터 조작

> 한양대학교 백현미 교수님의 강의 자료를 정리한 것입니다.

## 🏹 SELECT문

### 🎯 여러 테이블에 대한 조인 검색

![image-20210509160356103](12.데이터조작(57~).assets/image-20210509160356103.png)



![image-20210509160907310](12.데이터조작(57~).assets/image-20210509160907310.png)

![image-20210509162025207](12.데이터조작(57~).assets/image-20210509162025207.png)

```
Q) 판매 데이터베이스에서 banana 고객이 주문한 제품의 이름을 검색해보자

SELECT 제품.제품명
FROM 주문, 제품
WHERE 주문.주문고객 = 'banana' AND 제품.제품번호 = 주문.주문제품;
```

![image-20210509161434797](12.데이터조작(57~).assets/image-20210509161434797.png)



```
Q) 판매 데이터베이스에서 나이가 30세 이상의 고객이 주문한 제품의 주문제품과 주문일자를 검색해보자

SELECT 주문.주문제품, 주문.주문일자
FROM 고객, 주문
WHERE 고객.나이 >= 30 AND 고객.고객아이디 = 주문.주문고객;
```

![image-20210509161722700](12.데이터조작(57~).assets/image-20210509161722700.png)



```
Q) 판매 데이터베이스에서 고명석 고객이 주문한 제품의 제품명을 검색해보자

SELECT 제품.제품명
FROM 고객, 제품, 주문
WHERE 고객.고객이름 = '고명석' AND 고객.고객아이디 = 주문.주문고객 AND 제품.제품번호 = 주문.주문제품;
```

![image-20210509161920003](12.데이터조작(57~).assets/image-20210509161920003.png)



![image-20210509162121225](12.데이터조작(57~).assets/image-20210509162121225.png)



### 🎯부속 질의문을 이용한 검색

![image-20210509162201165](12.데이터조작(57~).assets/image-20210509162201165.png)

![image-20210509162349892](12.데이터조작(57~).assets/image-20210509162349892.png)

```
Q) 판매 데이터베이스에서 달콤비스켓과 같은 제조업체에서 제조한 제품의 제품명과 단가를 검색해보자

SELECT 제품명, 단가
FROM 제품
WHERE 제조업체 = (
                SELECT 제조업체
                FROM 제품
                WHERE 제품명= '달콤비스켓');
```

- '달콤 비스켓'의 제조업체는 '한빛제과' 밖에 없기 때문에 단일 행 부속 질의문 사용 ( 비교 연산자 '=' )



```
Q) 판매 데이터베이스에서 적립금이 가장 많은 고객의 고객이름과 적립금을 검색해보자

SELECT 고객이름, 적립금
FROM 고객
WHERE 적립금 = (
                SELECT MAX(적립금)
                FROM 고객);
```

-  최대 적립금은 단일 값이므로 단일 행 부속 질의문 사용



```
Q) 판매 데이터베이스에서 banana 고객이 주문한 제품의 제품명과 제조업체를 검색해보자


SELECT 제품명, 제조업체
FROM 제품
WHERE 주문제품 IN (
                	SELECT 주문제품
                	FROM 주문
                	WHERE 주문고객 = 'banana');
```

- 'banana ' 고객이 주문한 제품은 여러개이므로 다중 행 부속 질의문 사용 ( IN 연산자 )



```
Q) 판매 데이터베이스에서 banana 고객이 주문하지 않은 제품의 제품명과 제조업체를 검색해보자

SELECT 제품명, 제조업체
FROM 제품
WHERE 주문제품 NOT IN (
                	SELECT 주문제품
                	FROM 주문
                	WHERE 주문고객 = 'banana');
```



```
Q) 판매 데이터베이스에서 대한식품이 제조한 모든 제품의 단가보다 비싼 제품의 제품명, 단가, 제조업체를 검색해보자

SELECT 제품명, 단가, 제조업체
FROM 제품
WHERE 단가 >ALL (
                SELECT 단가
                FROM 제품
                WHERE 제조업체 = '대한식품');
```



## 🏹 INSERT문

### 🎯 데이터 직접 삽입

![image-20210509164509584](12.데이터조작(57~).assets/image-20210509164509584.png)



```
Q) 판매 데이터베이스의 고객 테이블에 고객 아이디가 strawberry, 고객이름이 최유경, 나이가 30세, 등급이 vip, 직업이 공무원, 적립금이 100원인 새로운 고객의 정보를 삽입해보자. 그런 다음 고객 테이블에 있는 모든 내용을 검색하여 삽입된 새로운 투플을 확인해보자.


INSERT
INTO 고객(고객아이디, 고객이름, 나이, 등급, 직업, 적립금)
VALUES ('strawberry', '최유경', 30, 'vip', '공무원', 100);

SELECT * FROM 고객;
```

![image-20210509165009761](12.데이터조작(57~).assets/image-20210509165009761.png)

- 고객 테이블의 모든 속성의 값을 차례대로 다 적어주었으므로 INTO에 내용 생략 가능



```
Q) 판매 데이터베이스의 고객 테이블에 고객아이디가 tomato, 고객이름이 정은심, 나이가 36세, 등급이 gold, 적립금은 4000원, 직업은 아직 모르는 새로운 고객의 정보를 삽입해보자. 그런 다음 고객 테이블에 있는 모든 내용을 검색하여 삽입된 정은심 고객의 직업이 NULL 값인지 확인해보자

INSERT
INTO 고객(고객아이디, 고객이름, 나이, 등급, 적립금)
VALUES ('tomato', '정은심', 36, 'gold', 4000);

SELECT * FROM 고객;
```

![image-20210509165440271](12.데이터조작(57~).assets/image-20210509165440271.png)



![image-20210509165512434](12.데이터조작(57~).assets/image-20210509165512434.png)

- NULL을 명시해주면 INTO 값 생략 가능



###  🎯 부속 질의문을 이용한 데이터 삽입

![image-20210509165558168](12.데이터조작(57~).assets/image-20210509165558168.png)



##  🏹 UPDATE 문

![image-20210509165643184](12.데이터조작(57~).assets/image-20210509165643184.png)

```
Q) 제품 테이블에서 제품번호가 p03인 제품의 제품명을 통큰파이로 수정해보자. 그런 다음 제품 테이블의 모든 내용을 검색하여 수정 내용을 확인해보자.

UPDATE 제품
SET 제품명 = '통큰파이'
WHERE 제품번호 = 'p03';

SELECT * FROM 제품;
```



```
Q) 제품 테이블에 있는 모든 제품의 단가를 10% 인상해보자.
그런 다음 제품 테이블의 모든 내용을 검색하여 인상 내용을 확인해보자

UPDATE 제품
SET 단가 = 단가 * 1.1;

SELECT * FROM 제품;
```



```
Q) 판매 데이터베이스에서 정소화 고객이 주문한 제품의 주문수량을 5개로 수정해보자.
그럼 다음 제품 테이블의 모든 내용을 검색하여 수정 내용을 확인해보자.

UPDATE 주문
SET 주문수량 = 5
WHERE 주문고객 = (
				SELECT 고객아이디
				FROM 고객
				WHERE 고객이름 = '정소화');
				
SELECT * FROM 주문;
```



##  🏹 DELETE문

![image-20210509170619233](12.데이터조작(57~).assets/image-20210509170619233.png)



```
Q) 판매 데이터베이스의 주문 테이블에 존재하는 모든 투플을 삭제해보자.
그럼 다음 주문 테이블의 모든 내용을 검색하여 삭제 여부를 확인해 보자.

DELETE
FROM 주문;

SELECT * FROM 주문;
```

![image-20210509170829967](12.데이터조작(57~).assets/image-20210509170829967.png)

- 빈 테이블이 남음, DROP TABLE과는 다름



![image-20210509171247525](12.데이터조작(57~).assets/image-20210509171247525.png)

- 단일행 부속 질의문의 경우도 IN 사용 가능 ( 위의 식은 '='로 대체 가능 )